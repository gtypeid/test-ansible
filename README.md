# Ansible í…ŒìŠ¤íŠ¸

Spring Boot + Nginx + MariaDB

<img width="510" height="441" alt="image" src="https://github.com/user-attachments/assets/749697c6-4bf1-4657-9f37-4b2f6dd7df08" />

---

## ì•„í‚¤í…ì²˜


```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   GitHub Repository                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ Build & Pull â”‚ â†’ JAR to GitHub Release               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ë¡œì»¬ ë§¥ (Ansible ì‹¤í–‰)                    â”‚
â”‚  ansible-playbook -i inventory.ini playbook-*.yml       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“               â†“               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend   â”‚ â”‚   Backend    â”‚ â”‚   Database   â”‚
â”‚  192.168.20  â”‚ â”‚  192.168.20  â”‚ â”‚  192.168.20  â”‚
â”‚     .192     â”‚ â”‚     .193     â”‚ â”‚     .194     â”‚
â”‚              â”‚ â”‚              â”‚ â”‚              â”‚
â”‚   Nginx      â”‚ â”‚ Spring Boot  â”‚ â”‚   MariaDB    â”‚
â”‚   Port 80    â”‚ â”‚  Port 8080   â”‚ â”‚  Port 3306   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
---

## ğŸŒ VM ë„¤íŠ¸ì›Œí¬ ì„¤ì •

### 1. UTMì—ì„œ VM ìƒì„±

ê° ì„œë²„ë§ˆë‹¤ Ubuntu 22.04 ARM64 ì´ë¯¸ì§€ë¡œ VM ìƒì„±

### 2. ê³ ì • IP ì„¤ì •

**ê° VMì—ì„œ ì‹¤í–‰:**

```bash
sudo vim /etc/netplan/00-installer-config.yaml
```

**Frontend (192.168.20.192):**
```yaml
network:
  version: 2
  ethernets:
    enp0s1:
      dhcp4: no
      addresses:
        - 192.168.20.192/24 
        # (192 / 193 / 194 ) ê° ì„¤ì • 
      routes:
        - to: default
          via: 192.168.20.1
      nameservers:
        addresses: [8.8.8.8, 8.8.4.4]
```
**ì ìš©:**
```bash
sudo netplan apply
```

## âš™ï¸ Ansible ì„¤ì •

### í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ansible-back/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ build.yml              # JAR ë¹Œë“œ & Release ìƒì„±
â”‚       â”œâ”€â”€ deploy-db.yml          # âŒ ë¯¸ì‚¬ìš© (ë¡œì»¬ì—ì„œ ì‹¤í–‰)
â”‚       â”œâ”€â”€ deploy-backend.yml     # âŒ ë¯¸ì‚¬ìš© (ë¡œì»¬ì—ì„œ ì‹¤í–‰)
â”‚       â””â”€â”€ deploy-frontend.yml    # âŒ ë¯¸ì‚¬ìš© (ë¡œì»¬ì—ì„œ ì‹¤í–‰)
â”œâ”€â”€ ansible/
â”‚   â”œâ”€â”€ inventory.ini              # ì„œë²„ ëª©ë¡
â”‚   â”œâ”€â”€ group_vars/
â”‚   â”‚   â””â”€â”€ all.yml               # ê³µí†µ ë³€ìˆ˜
â”‚   â”œâ”€â”€ playbook-db.yml           # DB ë°°í¬
â”‚   â”œâ”€â”€ playbook-backend.yml      # Backend ë°°í¬
â”‚   â””â”€â”€ playbook-frontend.yml     # Frontend ë°°í¬
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ app.js
â”‚   â””â”€â”€ css/
â”‚       â””â”€â”€ style.css
â””â”€â”€ src/                           # Spring Boot ì†ŒìŠ¤
```

### Inventory ì„¤ì •

**`ansible/inventory.ini`:**

### ë³€ìˆ˜ ì„¤ì •

**`ansible/group_vars/all.yml`:**

---

## ğŸš€ ë°°í¬ í”„ë¡œì„¸ìŠ¤

**GitHubì—ì„œ:**
```
Actions â†’ Build â†’ Run workflow í´ë¦­
â†’ JAR ë¹Œë“œ / GitHub Releaseì— ì—…ë¡œë“œ (latest íƒœê·¸)
â†’ Ansible Pull
```

### 2ï¸âƒ£ ë°°í¬ (ë¡œì»¬ Ansible ì‹¤í–‰)

**âš ï¸ ì¤‘ìš”: Deploy WorkflowsëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ!**

ë¡œì»¬ ë„¤íŠ¸ì›Œí¬(192.168.20.x)ëŠ” GitHub Actionsì—ì„œ ì ‘ê·¼ ë¶ˆê°€í•˜ë¯€ë¡œ, **ë¡œì»¬ ë§¥ì—ì„œ ì§ì ‘ Ansible ì‹¤í–‰**

#### Database ë°°í¬
```bash
cd /Users/mac/IdeaProjects/ansible-back/ansible
# or
ansible-playbook -i inventory.ini playbook-db.yml
# or
ansible-playbook -i inventory.ini playbook-backedn.yml
# or
ansible-playbook -i inventory.ini playbook-frontend.yml
```

**ì‹¤í–‰ ë‚´ìš©:**
- 20.192 : Nginxì„¤ì¹˜ ë° sites-available/enabled ì •ì  íŒŒì¼ copy 
- 20.193 : Java21 ì„¤ì¹˜ ë° Jar Pull ì‹¤í–‰ 
- 20.914 : MariaDB ì„¤ì¹˜ ë° User ì„¤ì •
---
